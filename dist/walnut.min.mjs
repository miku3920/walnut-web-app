var t={d:(e,n)=>{for(var i in n)t.o(n,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:n[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};t.d(e,{ZP:()=>W,B:()=>M,P6:()=>O});var n=Object.create||function(){function t(){}return function(e){var n;return t.prototype=e,n=new t,t.prototype=null,n}}(),i={extend:function(t){var e=n(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},r=i.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||o).stringify(this)},concat:function(t){var e=this.words,n=t.words,i=this.sigBytes,r=t.sigBytes;if(this.clamp(),i%4)for(var o=0;o<r;o++){var s=n[o>>>2]>>>24-o%4*8&255;e[i+o>>>2]|=s<<24-(i+o)%4*8}else for(var a=0;a<r;a+=4)e[i+a>>>2]=n[a>>>2];return this.sigBytes+=r,this},clamp:function(){var t=this.words,e=this.sigBytes;t[e>>>2]&=4294967295<<32-e%4*8,t.length=Math.ceil(e/4)},clone:function(){var t=i.clone.call(this);return t.words=this.words.slice(0),t}}),o={stringify:function(t){for(var e=t.words,n=t.sigBytes,i=[],r=0;r<n;r++){var o=e[r>>>2]>>>24-r%4*8&255;i.push((o>>>4).toString(16)),i.push((15&o).toString(16))}return i.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i+=2)n[i>>>3]|=parseInt(t.substr(i,2),16)<<24-i%8*4;return new r.init(n,e/2)}},s=function(t){return function(t){for(var e=t.length,n=[],i=0;i<e;i++)n[i>>>2]|=(255&t.charCodeAt(i))<<24-i%4*8;return new r.init(n,e)}(unescape(encodeURIComponent(t)))},a=i.extend({reset:function(){this._data=new r.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=s(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(t){var e,n=this._data,i=n.words,o=n.sigBytes,s=this.blockSize,a=o/(4*s),c=(a=t?Math.ceil(a):Math.max((0|a)-this._minBufferSize,0))*s,u=Math.min(4*c,o);if(c){for(var h=0;h<c;h+=s)this._doProcessBlock(i,h);e=i.splice(0,c),n.sigBytes-=u}return new r.init(e,u)},clone:function(){var t=i.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),c=a.extend({cfg:i.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){a.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16}),u=i.extend({init:function(t,e){t=this._hasher=new t.init,"string"==typeof e&&(e=s(e));var n=t.blockSize,i=4*n;e.sigBytes>i&&(e=t.finalize(e)),e.clamp();for(var r=this._oKey=e.clone(),o=this._iKey=e.clone(),a=r.words,c=o.words,u=0;u<n;u++)a[u]^=1549556828,c[u]^=909522486;r.sigBytes=o.sigBytes=i,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){var e=this._hasher,n=e.finalize(t);return e.reset(),e.finalize(this._oKey.clone().concat(n))}}),h=[],f=[];!function(){function t(t){for(var e=Math.sqrt(t),n=2;n<=e;n++)if(!(t%n))return!1;return!0}function e(t){return 4294967296*(t-(0|t))|0}for(var n=2,i=0;i<64;)t(n)&&(i<8&&(h[i]=e(Math.pow(n,.5))),f[i]=e(Math.pow(n,1/3)),i++),n++}();var l=[],d=c.extend({_doReset:function(){this._hash=new r.init(h.slice(0))},_doProcessBlock:function(t,e){for(var n=this._hash.words,i=n[0],r=n[1],o=n[2],s=n[3],a=n[4],c=n[5],u=n[6],h=n[7],d=0;d<64;d++){if(d<16)l[d]=0|t[e+d];else{var p=l[d-15],g=(p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3,y=l[d-2],v=(y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10;l[d]=g+l[d-7]+v+l[d-16]}var _=i&r^i&o^r&o,w=(i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22),m=h+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&c^~a&u)+f[d]+l[d];h=u,u=c,c=a,a=s+m|0,s=o,o=r,r=i,i=m+(w+_)|0}n[0]=n[0]+i|0,n[1]=n[1]+r|0,n[2]=n[2]+o|0,n[3]=n[3]+s|0,n[4]=n[4]+a|0,n[5]=n[5]+c|0,n[6]=n[6]+u|0,n[7]=n[7]+h|0},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return e[i>>>5]|=128<<24-i%32,e[14+(i+64>>>9<<4)]=Math.floor(n/4294967296),e[15+(i+64>>>9<<4)]=n,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=c.clone.call(this);return t._hash=this._hash.clone(),t}});const p=function(t,e,n){var i=new u.init(d,e).finalize(t);return n?i.toString():i};function g(t){const e=[];return Object.keys(t).sort().forEach((n=>{e.push(`${n}=${t[n]}`)})),e.join("\n")}function y(t){const{token:e}=t;delete t.token;const n=g(t),i=p(e,"WebAppData");return p(n,i,!0)}function v(t){return JSON.stringify(t).replace(/\//g,"\\/")}function _(t){return void 0!==t.user&&(t.user=v(t.user)),void 0!==t.receiver&&(t.receiver=v(t.receiver)),void 0!==t.chat&&(t.chat=v(t.chat)),t}function w(t){try{t=encodeURIComponent(t)}catch(t){}return t}function m(t){const e=[];return Object.keys(t).forEach((n=>{e.push(`${w(n)}=${w(t[n])}`)})),e.join("&")}function b(t){const e=t.Debug?"1":"",n=JSON.stringify(t.ThemeParams),i=`${t.Version}`,r=_(t.Data);r.hash=y(r);const o={tgWebAppData:m(r),tgWebAppVersion:i,tgWebAppThemeParams:n};return void 0!==t.Debug&&(o.tgWebAppDebug=e),`#${m(o)}`}function B(t){(t=t||{}).Data=t.Data||{},t.Data.user=t.Data.user||{id:127355800,first_name:"初音",last_name:"ミク",username:"miku3920",language_code:"zh-hant"},t.Data.auth_date=t.Data.auth_date||Date.now(),t.Data.token=t.Data.token||"1234567890:ABCDEFGHIJKLMNOPQRSTUVWXYZ",t.Version=t.Version||"6.2",t.ThemeParams=t.ThemeParams||{bg_color:"#ffffff",button_color:"#40a7e3",button_text_color:"#ffffff",hint_color:"#999999",link_color:"#168acd",text_color:"#000000"},t.Debug=t.Debug||!0,window.location.hash=b(t)}B();const S={setup:B,urlStringifyHashString:b,urlStringifyQueryParams:m,urlSafeEncode:w,stringifyDataParams:_,dataSafeStringify:v,createVerificationHash:y,buildDataCheckString:g,HMAC_SHA256:p},D={},x=()=>{},P=void 0!==window.TelegramWebviewProxy?(t,e)=>()=>{window.external&&window.external.invoke&&window.external.invoke(JSON.stringify([t,e]))}:(t,e)=>()=>{console.log("[Walnut.debug] postEvent",t,e)};function k(t,e){const n={type:t,data:e,post:P(t,e)},i=D[t]||D.default||x;try{i(n)}catch(t){}const r=D.all||x;try{r(n)}catch(t){}}D.default=t=>{console.log("[Walnut.default] postEvent",t.type,t.data)},D.all=x,window.TelegramWebviewProxy={postEvent:k};const z={on:function(t,e){D[t]=e},off:function(t){D[t]=x},receive:k},O=S,M=z,W={utils:S,event:z};var A=e.ZP,j=e.B,$=e.P6;export{A as default,j as event,$ as utils};
//# sourceMappingURL=walnut.min.mjs.map
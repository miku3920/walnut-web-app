import walnut from '@/factory.mjs'

test('query params should be stringify', () => {
  expect(walnut.utils.urlStringifyQueryParams({
    tgWebAppData: 'query_id=AAGAXhIqAgAAAIBeEiq9vGWf&user=%7B%22id%22%3A5000814208%2C%22first_name%22%3A%22%E5%88%9D%E9%9F%B3%22%2C%22last_name%22%3A%22%E3%83%9F%E3%82%AF%22%2C%22username%22%3A%22miku3920%22%2C%22language_code%22%3A%22zh-hant%22%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Fa-ttgme.stel.com%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2FQzCaPKoRQNuVxt5C380lpE3wirX0XmRobkgPmzk5ma9yd7wpSz64DfLCMn6TBe1o.svg%22%7D&receiver=%7B%22id%22%3A3593%2C%22is_bot%22%3Atrue%2C%22first_name%22%3A%22BotFather%22%2C%22last_name%22%3A%22%22%2C%22username%22%3A%22botfather%22%2C%22photo_url%22%3A%22https%3A%5C%2F%5C%2Fa-ttgme.stel.com%5C%2Fi%5C%2Fuserpic%5C%2F320%5C%2FIXVj0cIEa6e-0VHnsP0AdudAmaQsFavgezL8jLZQD_c.svg%22%7D&auth_date=1657787172&hash=bfc3f1e4a37c859f1d9049dcb7ca1b9de670323f24911178001f6f8d5f25092a',
    tgWebAppVersion: 6.2,
    tgWebAppThemeParams: '{"bg_color":"#ffffff","button_color":"#40a7e3","button_text_color":"#ffffff","hint_color":"#999999","link_color":"#168acd","text_color":"#000000"}',
  })).toBe('tgWebAppData=query_id%3DAAGAXhIqAgAAAIBeEiq9vGWf%26user%3D%257B%2522id%2522%253A5000814208%252C%2522first_name%2522%253A%2522%25E5%2588%259D%25E9%259F%25B3%2522%252C%2522last_name%2522%253A%2522%25E3%2583%259F%25E3%2582%25AF%2522%252C%2522username%2522%253A%2522miku3920%2522%252C%2522language_code%2522%253A%2522zh-hant%2522%252C%2522photo_url%2522%253A%2522https%253A%255C%252F%255C%252Fa-ttgme.stel.com%255C%252Fi%255C%252Fuserpic%255C%252F320%255C%252FQzCaPKoRQNuVxt5C380lpE3wirX0XmRobkgPmzk5ma9yd7wpSz64DfLCMn6TBe1o.svg%2522%257D%26receiver%3D%257B%2522id%2522%253A3593%252C%2522is_bot%2522%253Atrue%252C%2522first_name%2522%253A%2522BotFather%2522%252C%2522last_name%2522%253A%2522%2522%252C%2522username%2522%253A%2522botfather%2522%252C%2522photo_url%2522%253A%2522https%253A%255C%252F%255C%252Fa-ttgme.stel.com%255C%252Fi%255C%252Fuserpic%255C%252F320%255C%252FIXVj0cIEa6e-0VHnsP0AdudAmaQsFavgezL8jLZQD_c.svg%2522%257D%26auth_date%3D1657787172%26hash%3Dbfc3f1e4a37c859f1d9049dcb7ca1b9de670323f24911178001f6f8d5f25092a&tgWebAppVersion=6.2&tgWebAppThemeParams=%7B%22bg_color%22%3A%22%23ffffff%22%2C%22button_color%22%3A%22%2340a7e3%22%2C%22button_text_color%22%3A%22%23ffffff%22%2C%22hint_color%22%3A%22%23999999%22%2C%22link_color%22%3A%22%23168acd%22%2C%22text_color%22%3A%22%23000000%22%7D')
})
